"use client"

import type React from "react"
import { createContext, useContext, useState, useEffect } from "react"

// Langues support√©es
export type Language = "fr" | "en" | "es" | "de" | "zh" | "ar"

// Interface pour le contexte de langue
interface LanguageContextType {
    language: Language
    setLanguage: (lang: Language) => void
    t: (key: string) => string
    languages: { code: Language; name: string; flag: string }[]
}

// Cr√©ation du contexte
const LanguageContext = createContext<LanguageContextType | undefined>(undefined)

// D√©finition des langues disponibles
const availableLanguages = [
    { code: "fr" as Language, name: "Fran√ßais", flag: "üá´üá∑" },
    { code: "en" as Language, name: "English", flag: "üá¨üáß" },
    { code: "es" as Language, name: "Espa√±ol", flag: "üá™üá∏" },
    { code: "de" as Language, name: "Deutsch", flag: "üá©üá™" },
    { code: "zh" as Language, name: "‰∏≠Êñá", flag: "üá®üá≥" },
    { code: "ar" as Language, name: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©", flag: "üá∏üá¶" },
]

// Traductions
const translations: Record<Language, Record<string, string>> = {
    fr: {
        // Navigation
        "nav.home": "Accueil",
        "nav.prediction": "Pr√©diction",
        "nav.dashboard": "Dashboard",
        "nav.about": "√Ä propos",
        "nav.login": "Connexion",
        "nav.register": "S'inscrire",
        "nav.profile": "Mon profil",
        "nav.settings": "Param√®tres",
        "nav.logout": "D√©connexion",

        // Page d'accueil
        "home.title": "Tri automatique des prunes",
        "home.subtitle":
            "Une solution innovante utilisant l'intelligence artificielle pour classifier les prunes en six cat√©gories distinctes avec une pr√©cision exceptionnelle.",
        "home.cta": "Tester maintenant",
        "home.how.title": "Comment √ßa marche",
        "home.how.description":
            "Notre syst√®me utilise des algorithmes avanc√©s de vision par ordinateur pour analyser et classifier les prunes avec une grande pr√©cision.",

        // Authentification
        "auth.login.title": "Connexion",
        "auth.login.subtitle": "Connectez-vous pour acc√©der √† votre tableau de bord et g√©rer vos analyses de prunes",
        "auth.register.title": "Cr√©er un compte",
        "auth.register.subtitle": "Rejoignez TriPrune pour acc√©der √† toutes les fonctionnalit√©s d'analyse de prunes",
        "auth.forgot.title": "Mot de passe oubli√©",
        "auth.forgot.subtitle": "R√©initialisez votre mot de passe pour r√©cup√©rer l'acc√®s √† votre compte",

        // Pr√©diction
        "prediction.title": "Analyse de prunes",
        "prediction.subtitle":
            "T√©l√©chargez une image de prune pour l'analyser avec notre intelligence artificielle avanc√©e",
        "prediction.upload": "T√©l√©chargez une image de prune",
        "prediction.analyze": "Analyser",
        "prediction.results": "R√©sultats de l'analyse",

        // Cat√©gories de prunes
        "category.good": "Bonne qualit√©",
        "category.unripe": "Non m√ªre",
        "category.spotted": "Tachet√©e",
        "category.cracked": "Fissur√©e",
        "category.bruised": "Meurtrie",
        "category.rotten": "Pourrie",

        // Footer
        "footer.copyright": "¬© 2025 TriPrune - Projet JCIA Hackathon",
    },

    en: {
        // Navigation
        "nav.home": "Home",
        "nav.prediction": "Prediction",
        "nav.dashboard": "Dashboard",
        "nav.about": "About",
        "nav.login": "Login",
        "nav.register": "Sign up",
        "nav.profile": "My profile",
        "nav.settings": "Settings",
        "nav.logout": "Logout",

        // Home page
        "home.title": "Automatic plum sorting",
        "home.subtitle":
            "An innovative solution using artificial intelligence to classify plums into six distinct categories with exceptional accuracy.",
        "home.cta": "Try it now",
        "home.how.title": "How it works",
        "home.how.description":
            "Our system uses advanced computer vision algorithms to analyze and classify plums with high precision.",

        // Authentication
        "auth.login.title": "Login",
        "auth.login.subtitle": "Sign in to access your dashboard and manage your plum analyses",
        "auth.register.title": "Create an account",
        "auth.register.subtitle": "Join TriPrune to access all plum analysis features",
        "auth.forgot.title": "Forgot password",
        "auth.forgot.subtitle": "Reset your password to regain access to your account",

        // Prediction
        "prediction.title": "Plum Analysis",
        "prediction.subtitle": "Upload a plum image to analyze it with our advanced artificial intelligence",
        "prediction.upload": "Upload a plum image",
        "prediction.analyze": "Analyze",
        "prediction.results": "Analysis results",

        // Plum categories
        "category.good": "Good quality",
        "category.unripe": "Unripe",
        "category.spotted": "Spotted",
        "category.cracked": "Cracked",
        "category.bruised": "Bruised",
        "category.rotten": "Rotten",

        // Footer
        "footer.copyright": "¬© 2025 TriPrune - JCIA Hackathon Project",
    },

    es: {
        // Navigation
        "nav.home": "Inicio",
        "nav.prediction": "Predicci√≥n",
        "nav.dashboard": "Panel",
        "nav.about": "Acerca de",
        "nav.login": "Iniciar sesi√≥n",
        "nav.register": "Registrarse",
        "nav.profile": "Mi perfil",
        "nav.settings": "Configuraci√≥n",
        "nav.logout": "Cerrar sesi√≥n",

        // Home page
        "home.title": "Clasificaci√≥n autom√°tica de ciruelas",
        "home.subtitle":
            "Una soluci√≥n innovadora que utiliza inteligencia artificial para clasificar ciruelas en seis categor√≠as distintas con precisi√≥n excepcional.",
        "home.cta": "Probar ahora",
        "home.how.title": "C√≥mo funciona",
        "home.how.description":
            "Nuestro sistema utiliza algoritmos avanzados de visi√≥n por computadora para analizar y clasificar ciruelas con gran precisi√≥n.",

        // Authentication
        "auth.login.title": "Iniciar sesi√≥n",
        "auth.login.subtitle": "Inicie sesi√≥n para acceder a su panel y gestionar sus an√°lisis de ciruelas",
        "auth.register.title": "Crear una cuenta",
        "auth.register.subtitle": "√önase a TriPrune para acceder a todas las funciones de an√°lisis de ciruelas",
        "auth.forgot.title": "Contrase√±a olvidada",
        "auth.forgot.subtitle": "Restablezca su contrase√±a para recuperar el acceso a su cuenta",

        // Prediction
        "prediction.title": "An√°lisis de ciruelas",
        "prediction.subtitle": "Suba una imagen de ciruela para analizarla con nuestra inteligencia artificial avanzada",
        "prediction.upload": "Subir una imagen de ciruela",
        "prediction.analyze": "Analizar",
        "prediction.results": "Resultados del an√°lisis",

        // Plum categories
        "category.good": "Buena calidad",
        "category.unripe": "No madura",
        "category.spotted": "Manchada",
        "category.cracked": "Agrietada",
        "category.bruised": "Magullada",
        "category.rotten": "Podrida",

        // Footer
        "footer.copyright": "¬© 2025 TriPrune - Proyecto Hackathon JCIA",
    },

    de: {
        // Navigation
        "nav.home": "Startseite",
        "nav.prediction": "Vorhersage",
        "nav.dashboard": "Dashboard",
        "nav.about": "√úber uns",
        "nav.login": "Anmelden",
        "nav.register": "Registrieren",
        "nav.profile": "Mein Profil",
        "nav.settings": "Einstellungen",
        "nav.logout": "Abmelden",

        // Home page
        "home.title": "Automatische Pflaumensortierung",
        "home.subtitle":
            "Eine innovative L√∂sung, die k√ºnstliche Intelligenz nutzt, um Pflaumen mit au√üergew√∂hnlicher Genauigkeit in sechs verschiedene Kategorien zu klassifizieren.",
        "home.cta": "Jetzt testen",
        "home.how.title": "Wie es funktioniert",
        "home.how.description":
            "Unser System verwendet fortschrittliche Computer-Vision-Algorithmen, um Pflaumen mit hoher Pr√§zision zu analysieren und zu klassifizieren.",

        // Authentication
        "auth.login.title": "Anmelden",
        "auth.login.subtitle":
            "Melden Sie sich an, um auf Ihr Dashboard zuzugreifen und Ihre Pflaumenanalysen zu verwalten",
        "auth.register.title": "Konto erstellen",
        "auth.register.subtitle": "Treten Sie TriPrune bei, um Zugang zu allen Pflaumenanalyse-Funktionen zu erhalten",
        "auth.forgot.title": "Passwort vergessen",
        "auth.forgot.subtitle": "Setzen Sie Ihr Passwort zur√ºck, um wieder Zugriff auf Ihr Konto zu erhalten",

        // Prediction
        "prediction.title": "Pflaumenanalyse",
        "prediction.subtitle":
            "Laden Sie ein Pflaumenbild hoch, um es mit unserer fortschrittlichen k√ºnstlichen Intelligenz zu analysieren",
        "prediction.upload": "Pflaumenbild hochladen",
        "prediction.analyze": "Analysieren",
        "prediction.results": "Analyseergebnisse",

        // Plum categories
        "category.good": "Gute Qualit√§t",
        "category.unripe": "Unreif",
        "category.spotted": "Fleckig",
        "category.cracked": "Rissig",
        "category.bruised": "Gequetscht",
        "category.rotten": "Verfault",

        // Footer
        "footer.copyright": "¬© 2025 TriPrune - JCIA Hackathon Projekt",
    },

    zh: {
        // Navigation
        "nav.home": "È¶ñÈ°µ",
        "nav.prediction": "È¢ÑÊµã",
        "nav.dashboard": "‰ª™Ë°®Êùø",
        "nav.about": "ÂÖ≥‰∫é",
        "nav.login": "ÁôªÂΩï",
        "nav.register": "Ê≥®ÂÜå",
        "nav.profile": "ÊàëÁöÑËµÑÊñô",
        "nav.settings": "ËÆæÁΩÆ",
        "nav.logout": "ÁôªÂá∫",

        // Home page
        "home.title": "Ëá™Âä®ÊùéÂ≠êÂàÜÁ±ª",
        "home.subtitle": "‰∏ÄÁßçÂàõÊñ∞Ëß£ÂÜ≥ÊñπÊ°àÔºå‰ΩøÁî®‰∫∫Â∑•Êô∫ËÉΩ‰ª•ÂçìË∂äÁöÑÁ≤æÂ∫¶Â∞ÜÊùéÂ≠êÂàÜ‰∏∫ÂÖ≠‰∏™‰∏çÂêåÁ±ªÂà´„ÄÇ",
        "home.cta": "Á´ãÂç≥ÊµãËØï",
        "home.how.title": "Â∑•‰ΩúÂéüÁêÜ",
        "home.how.description": "Êàë‰ª¨ÁöÑÁ≥ªÁªü‰ΩøÁî®ÂÖàËøõÁöÑËÆ°ÁÆóÊú∫ËßÜËßâÁÆóÊ≥ïÔºå‰ª•È´òÁ≤æÂ∫¶ÂàÜÊûêÂíåÂàÜÁ±ªÊùéÂ≠ê„ÄÇ",

        // Authentication
        "auth.login.title": "ÁôªÂΩï",
        "auth.login.subtitle": "ÁôªÂΩï‰ª•ËÆøÈóÆÊÇ®ÁöÑ‰ª™Ë°®ÊùøÂπ∂ÁÆ°ÁêÜÊÇ®ÁöÑÊùéÂ≠êÂàÜÊûê",
        "auth.register.title": "ÂàõÂª∫Ë¥¶Êà∑",
        "auth.register.subtitle": "Âä†ÂÖ•TriPruneÔºåËÆøÈóÆÊâÄÊúâÊùéÂ≠êÂàÜÊûêÂäüËÉΩ",
        "auth.forgot.title": "ÂøòËÆ∞ÂØÜÁ†Å",
        "auth.forgot.subtitle": "ÈáçÁΩÆÂØÜÁ†Å‰ª•ÈáçÊñ∞Ëé∑ÂæóË¥¶Êà∑ËÆøÈóÆÊùÉÈôê",

        // Prediction
        "prediction.title": "ÊùéÂ≠êÂàÜÊûê",
        "prediction.subtitle": "‰∏ä‰º†ÊùéÂ≠êÂõæÂÉèÔºåÁî®Êàë‰ª¨ÁöÑÂÖàËøõ‰∫∫Â∑•Êô∫ËÉΩËøõË°åÂàÜÊûê",
        "prediction.upload": "‰∏ä‰º†ÊùéÂ≠êÂõæÂÉè",
        "prediction.analyze": "ÂàÜÊûê",
        "prediction.results": "ÂàÜÊûêÁªìÊûú",

        // Plum categories
        "category.good": "‰ºòË¥®",
        "category.unripe": "Êú™ÊàêÁÜü",
        "category.spotted": "ÊúâÊñëÁÇπ",
        "category.cracked": "ÊúâË£ÇÁºù",
        "category.bruised": "ÊúâÁòÄ‰º§",
        "category.rotten": "ËÖêÁÉÇ",

        // Footer
        "footer.copyright": "¬© 2025 TriPrune - JCIAÈªëÂÆ¢È©¨ÊãâÊùæÈ°πÁõÆ",
    },

    ar: {
        // Navigation
        "nav.home": "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
        "nav.prediction": "ÿßŸÑÿ™ŸÜÿ®ÿ§",
        "nav.dashboard": "ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
        "nav.about": "ÿ≠ŸàŸÑ",
        "nav.login": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
        "nav.register": "ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ",
        "nav.profile": "ŸÖŸÑŸÅŸä ÿßŸÑÿ¥ÿÆÿµŸä",
        "nav.settings": "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
        "nav.logout": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨",

        // Home page
        "home.title": "ŸÅÿ±ÿ≤ ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä",
        "home.subtitle": "ÿ≠ŸÑ ŸÖÿ®ÿ™ŸÉÿ± Ÿäÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ŸÑÿ™ÿµŸÜŸäŸÅ ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ ÿ•ŸÑŸâ ÿ≥ÿ™ ŸÅÿ¶ÿßÿ™ ŸÖÿ™ŸÖŸäÿ≤ÿ© ÿ®ÿØŸÇÿ© ÿßÿ≥ÿ™ÿ´ŸÜÿßÿ¶Ÿäÿ©.",
        "home.cta": "ÿ¨ÿ±ÿ® ÿßŸÑÿ¢ŸÜ",
        "home.how.title": "ŸÉŸäŸÅ ŸäÿπŸÖŸÑ",
        "home.how.description": "Ÿäÿ≥ÿ™ÿÆÿØŸÖ ŸÜÿ∏ÿßŸÖŸÜÿß ÿÆŸàÿßÿ±ÿ≤ŸÖŸäÿßÿ™ ÿ±ÿ§Ÿäÿ© ÿßŸÑŸÉŸÖÿ®ŸäŸàÿ™ÿ± ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ© ŸÑÿ™ÿ≠ŸÑŸäŸÑ Ÿàÿ™ÿµŸÜŸäŸÅ ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ ÿ®ÿØŸÇÿ© ÿπÿßŸÑŸäÿ©.",

        // Authentication
        "auth.login.title": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
        "auth.login.subtitle": "ŸÇŸÖ ÿ®ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿÆÿßÿµÿ© ÿ®ŸÉ Ÿàÿ•ÿØÿßÿ±ÿ© ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ",
        "auth.register.title": "ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®",
        "auth.register.subtitle": "ÿßŸÜÿ∂ŸÖ ÿ•ŸÑŸâ TriPrune ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿ¨ŸÖŸäÿπ ŸÖŸäÿ≤ÿßÿ™ ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ",
        "auth.forgot.title": "ŸÜÿ≥Ÿäÿ™ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
        "auth.forgot.subtitle": "ÿ£ÿπÿØ ÿ™ÿπŸäŸäŸÜ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÑÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿ≠ÿ≥ÿßÿ®ŸÉ",

        // Prediction
        "prediction.title": "ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ",
        "prediction.subtitle": "ŸÇŸÖ ÿ®ÿ™ÿ≠ŸÖŸäŸÑ ÿµŸàÿ±ÿ© ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ ŸÑÿ™ÿ≠ŸÑŸäŸÑŸáÿß ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ÿßŸÑŸÖÿ™ŸÇÿØŸÖ",
        "prediction.upload": "ÿ™ÿ≠ŸÖŸäŸÑ ÿµŸàÿ±ÿ© ÿßŸÑÿ®ÿ±ŸÇŸàŸÇ",
        "prediction.analyze": "ÿ™ÿ≠ŸÑŸäŸÑ",
        "prediction.results": "ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ",

        // Plum categories
        "category.good": "ÿ¨ŸàÿØÿ© ÿ¨ŸäÿØÿ©",
        "category.unripe": "ÿ∫Ÿäÿ± ŸÜÿßÿ∂ÿ¨",
        "category.spotted": "ŸÖÿ®ŸÇÿπ",
        "category.cracked": "ŸÖÿ™ÿ¥ŸÇŸÇ",
        "category.bruised": "ŸÖŸÉÿØŸàŸÖ",
        "category.rotten": "ŸÅÿßÿ≥ÿØ",

        // Footer
        "footer.copyright": "¬© 2025 TriPrune - ŸÖÿ¥ÿ±Ÿàÿπ ŸáÿßŸÉÿßÿ´ŸàŸÜ JCIA",
    },
}

// Provider du contexte de langue
export const LanguageProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
    // R√©cup√©rer la langue du navigateur ou utiliser le fran√ßais par d√©faut
    const getBrowserLanguage = (): Language => {
        const browserLang = navigator.language.split("-")[0]
        return (availableLanguages.find((lang) => lang.code === browserLang)?.code || "fr") as Language
    }

    // √âtat pour stocker la langue actuelle
    const [language, setLanguageState] = useState<Language>(() => {
        // R√©cup√©rer la langue depuis le localStorage ou utiliser la langue du navigateur
        const savedLanguage = localStorage.getItem("triprune_language")
        return (savedLanguage as Language) || getBrowserLanguage()
    })

    // Fonction pour changer de langue
    const setLanguage = (lang: Language) => {
        setLanguageState(lang)
        localStorage.setItem("triprune_language", lang)

        // Mettre √† jour l'attribut dir pour les langues RTL (comme l'arabe)
        if (lang === "ar") {
            document.documentElement.dir = "rtl"
            document.documentElement.lang = lang
        } else {
            document.documentElement.dir = "ltr"
            document.documentElement.lang = lang
        }
    }

    // Effet pour initialiser la direction du document
    useEffect(() => {
        if (language === "ar") {
            document.documentElement.dir = "rtl"
            document.documentElement.lang = language
        } else {
            document.documentElement.dir = "ltr"
            document.documentElement.lang = language
        }
    }, [language])

    // Fonction de traduction
    const t = (key: string): string => {
        return translations[language][key] || key
    }

    const value = {
        language,
        setLanguage,
        t,
        languages: availableLanguages,
    }

    return <LanguageContext.Provider value={value}>{children}</LanguageContext.Provider>
}

// Hook personnalis√© pour utiliser le contexte de langue
export const useLanguage = () => {
    const context = useContext(LanguageContext)
    if (context === undefined) {
        throw new Error("useLanguage doit √™tre utilis√© √† l'int√©rieur d'un LanguageProvider")
    }
    return context
}
